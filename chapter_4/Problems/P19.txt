P19. Suppose you are interested in detecting the number of hosts behind a NAT.

You observe that the IP layer stamps an identification number sequentially on
each IP packet. The identification number of the first IP packet generated by
a host is a random number, and the identification numbers of the subsequent
IP packets are sequentially assigned. Assume all IP packets generated by
hosts behind the NAT are sent to the outside world.

a. Based on this observation, and assuming you can sniff all packets sent by
the NAT to the outside, can you outline a simple technique that detects the
number of unique hosts behind a NAT? Justify your answer.

b. If the identification numbers are not sequentially assigned but randomly
assigned, would your technique work? Justify your answer.
---------

a.Yes. I would monitor the IP Identification field in packets leaving the NAT. Since each host starts at a random ID and then increments sequentially, 
I can group packets into sequences of consecutive IDs. Each independent sequence corresponds to one host. 

By counting sequences, I can estimate the number of hosts behind the NAT

b. If IDs are randomly assigned, the technique fails. Without sequential patterns, you can’t group packets to a specific host, so it’s impossible to estimate host count